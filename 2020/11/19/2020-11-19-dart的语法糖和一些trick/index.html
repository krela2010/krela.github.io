
<!DOCTYPE html>
<html lang="zh-cn">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="">
    <title>dart的语法糖和一些trick - null</title>
    <meta name="author" content="krela">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"krela","sameAs":["https://github.com/","http://stackoverflow.com/users","mailto"]},"articleBody":"知道这些tips,可以写出更简洁的代码\n\n\n1.string的乘法1234567891011void main() &#123;  for (var i = 1; i &lt;= 5; i++) &#123;    print(&#x27;🎄&#x27; * i);  &#125;&#125;// Output:// 🎄// 🎄🎄// 🎄🎄🎄// 🎄🎄🎄🎄// 🎄🎄🎄🎄🎄\n\n2.同步调用Future函数123456//演示数据class CovidAPI &#123;  Future&lt;int&gt; getCases() =&gt; Future.value(1000);  Future&lt;int&gt; getRecovered() =&gt; Future.value(100);  Future&lt;int&gt; getDeaths() =&gt; Future.value(10);&#125;\n\n使用Future.wait\n1234567final api = CovidAPI();final values = await Future.wait([    api.getCases(),    api.getRecovered(),    api.getDeaths(),]);print(values); // [1000, 100, 10]\n\n3.类里的call方法12345class PasswordValidator &#123;  bool call(String password) &#123;    return password.length &gt; 10;  &#125;&#125;\n\n可以像方法一样直接通过实例对象调用,\n两种调用方式\n123456final validator = PasswordValidator();// can use it like this:validator(&#x27;test&#x27;);validator(&#x27;test1234&#x27;);// no need to use it like this:validator.call(&#x27;not-so-frozen-arctic&#x27;);\n\n\n\n4用”?.call()”调用回调函数避免为空1234567891011//demo类class CustomDraggable extends StatelessWidget &#123;  const CustomDraggable(&#123;Key key, this.onDragCompleted&#125;) : super(key: key);  final VoidCallback? onDragCompleted;  void _dragComplete() &#123;    // TODO: Implement me  &#125;  @override  Widget build(BuildContext context) &#123;/*...*/&#125;&#125;\n\n这是传统写法\n12345void _dragComplete() &#123;    if (onDragCompleted != null) &#123;      onDragCompleted();    &#125;  &#125;\n\n另一种简便写法,为null就不会调用了,和上面等效\n123Future&lt;void&gt; _dragComplete() async &#123;   onDragCompleted?.call(); &#125;\n\n\n\n5.函数作为参数传递dart里函数也是一等公民,具有和其他变量同等待遇\n12345678910void main() &#123;  final sayHi = (name) =&gt; &#x27;Hi, $name&#x27;;  welcome(sayHi, &#x27;Andrea&#x27;);&#125;void welcome(String Function(String) greet,             String name) &#123;  print(greet(name));  print(&#x27;Welcome to this course&#x27;);&#125;\n\n\n\n6.容器判断和容器展开…可以把容器的元素展开,也可以在容器里添加if判断语法\n123456789const addRatings = true;const restaurant = &#123;  &#x27;name&#x27; : &#x27;Pizza Mario&#x27;,  &#x27;cuisine&#x27;: &#x27;Italian&#x27;,  if (addRatings) ...&#123;    &#x27;avgRating&#x27;: 4.3,    &#x27;numRatings&#x27;: 5,  &#125;&#125;;\n\n\n\n7.安全遍历map”.entries”1234for (var entry in timeSpent.entries) &#123;  // do something with keys and values  print(&#x27;$&#123;entry.key&#125;: $&#123;entry.value&#125;&#x27;);&#125;\n\n比遍历key安全\n1234for (var key in timeSpent.keys) &#123;  final value = timeSpent[key];  print(&#x27;$key: $value&#x27;);&#125;\n\n这个实现如果key对应的value是null,就会报错\n8.使用命名构造函数,更具有维护性,可读性123456class Temperature &#123;  Temperature.celsius(this.celsius);  Temperature.fahrenheit(double fahrenheit)    : celsius = (fahrenheit - 32) / 1.8;  double celsius;&#125;\n\n\n\n9.Getter和Setterdart里的getter和setter的语法\n12345678910class Temperature &#123;  Temperature.celsius(this.celsius);  Temperature.fahrenheit(double fahrenheit)    : celsius = (fahrenheit - 32) / 1.8;  double celsius;  double get fahrenheit    =&gt; celsius * 1.8 + 32;  set fahrenheit(double fahrenheit)    =&gt; celsius = (fahrenheit - 32) / 1.8;&#125;\n\n\n\n1234final temp1 = Temperature.celsius(30);print(temp1.fahrenheit);final temp2 = Temperature.fahrenheit(90);temp2.celsius = 28;\n\n\n\n10.用_下划线代替未使用的参数\n1234567891011class MyListView extends StatelessWidget &#123;  @override  Widget build(BuildContext context) &#123;    return ListView.builder(      itemBuilder: (context, index) =&gt; ListTile(        title: Text(&#x27;all the same&#x27;),      ),      itemCount: 10,    );  &#125;&#125;\n\n如果不使用context,index,可以写成如下\n123456istView.builder(  itemBuilder: (_, __) =&gt; ListTile(    title: Text(&#x27;all the same&#x27;),  ),  itemCount: 10,)\n\n_和__代表不同的参数\n11.单例实现dart的单例实现方式\n12345// file_system.dartclass FileSystem &#123;  FileSystem._();  static final instance = FileSystem._();&#125;\n\n无法实例化,仅能通过以下方式访问\n123// some_other_file.dartfinal fs = FileSystem.instance;// do something with fs\n\n\n\n12.Set\n如果需要一个不包含重复元素的集合,那么使用Set\n一个细节,如果使用final 修饰set,有重复元素只会提示warning\n1234567// set is final, compilesfinal citiesSet = &#123;  &#x27;London&#x27;,  &#x27;Paris&#x27;,  &#x27;Rome&#x27;,  &#x27;London&#x27;, // Two elements in a set literal shouldn&#x27;t be equal&#125;;\n\n如果用const修复,会提示无法编译\n1234567// set is const, doesn&#x27;t compileconst citiesSet = &#123;  &#x27;London&#x27;,  &#x27;Paris&#x27;,  &#x27;Rome&#x27;,  &#x27;London&#x27;, // Two elements in a constant set literal can&#x27;t be equal&#125;;\n\n\n\n\n\n\n\nTODO\n15. Common Stream constructorsThe Stream class also comes with some handy constructors. Here are the most common ones:\n123456Stream.fromIterable([1, 2, 3]);Stream.value(10);Stream.empty();Stream.error(Exception(&#x27;something went wrong&#x27;));Stream.fromFuture(Future.delayed(Duration(seconds: 1), () =&gt; 42));Stream.periodic(Duration(seconds: 1), (index) =&gt; index);\n\n\nuse Stream.fromIterable to create a Stream from a list of values.\nuse Stream.value if you have just one value.\nuse Stream.empty to create an empty stream.\nuse Stream.error to create a stream that contains an error value.\nuse Stream.fromFuture to create a stream that will contain only one value, and that value will be available when the future completes.\nuse Stream.periodic to create a periodic stream of events. You can specify a Duration as the time interval between events, and an anonymous function to generate each value given its index in the stream.\n\n16. Sync and Async GeneratorsIn Dart we can define a synchronous generator as a function that returns an Iterable:\n12345Iterable&lt;int&gt; count(int n) sync* &#123;  for (var i = 1; i &lt;= n; i++) &#123;    yield i;  &#125;&#125;\n\nThis uses the sync* syntax. Inside the function we can “generate” or yield multiple values. These will be returned as an Iterable when the function completes.\n\nOn the other hand, an asynchronous generator is a function that returns a Stream:\n12345Stream&lt;int&gt; countStream(int n) async* &#123;  for (var i = 1; i &lt;= n; i++) &#123;    yield i;  &#125;&#125;\n\nThis uses this async* syntax. Inside the function we can yield values just like in the synchronous case.\nBut if we want we can await on Future-based APIs, because this is an asynchronous generator:\n1234567Stream&lt;int&gt; countStream(int n) async* &#123;  for (var i = 1; i &lt;= n; i++) &#123;    // dummy delay - this could be a network request    await Future.delayed(Duration(seconds: 1));    yield i;  &#125;&#125;\n\n\n\n转自\nhttps://codewithandrea.com/videos/2020-11-16-top-dart-tips-and-tricks-for-flutter-devs/#8-use-named-constructors-and-initializer-lists-for-more-ergonomic-apis\n","dateCreated":"2020-11-19T12:15:44+08:00","dateModified":"2020-11-19T12:49:45+08:00","datePublished":"2020-11-19T12:15:44+08:00","description":"知道这些tips,可以写出更简洁的代码","headline":"dart的语法糖和一些trick","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2020/11/19/2020-11-19-dart%E7%9A%84%E8%AF%AD%E6%B3%95%E7%B3%96%E5%92%8C%E4%B8%80%E4%BA%9Btrick/"},"publisher":{"@type":"Organization","name":"krela","sameAs":["https://github.com/","http://stackoverflow.com/users","mailto"]},"url":"http://example.com/2020/11/19/2020-11-19-dart%E7%9A%84%E8%AF%AD%E6%B3%95%E7%B3%96%E5%92%8C%E4%B8%80%E4%BA%9Btrick/","keywords":"flutter"}</script>
    <meta name="description" content="知道这些tips,可以写出更简洁的代码">
<meta property="og:type" content="blog">
<meta property="og:title" content="dart的语法糖和一些trick">
<meta property="og:url" content="http://example.com/2020/11/19/2020-11-19-dart%E7%9A%84%E8%AF%AD%E6%B3%95%E7%B3%96%E5%92%8C%E4%B8%80%E4%BA%9Btrick/index.html">
<meta property="og:site_name">
<meta property="og:description" content="知道这些tips,可以写出更简洁的代码">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-11-19T04:15:44.000Z">
<meta property="article:modified_time" content="2020-11-19T04:49:45.636Z">
<meta property="article:author" content="krela">
<meta property="article:tag" content="flutter">
<meta name="twitter:card" content="summary">
    
    
        
    
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/style-q1xm6d2tdcpkqfz9o6p1p6qdzbvnnvu0hbyenhmww9tanqfaayxelx72glmt.min.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="打开链接: /#about"
            >
        
        
        </a>
    
</header>

            <!-- Define author's picture -->


<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="首页"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">首页</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="分类"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">分类</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="标签"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">标签</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="归档"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">归档</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="http://stackoverflow.com/users"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Stack Overflow"
                        >
                        <i class="sidebar-button-icon fab fa-stack-overflow" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Stack Overflow</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/mailto"
                            
                            rel="noopener"
                            title="邮箱"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">邮箱</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            dart的语法糖和一些trick
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2020-11-19T12:15:44+08:00">
	
		    11月 19, 2020
    	
    </time>
    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <p>知道这些tips,可以写出更简洁的代码</p>
<a id="more"></a>

<h6 id="1-string的乘法"><a href="#1-string的乘法" class="headerlink" title="1.string的乘法"></a>1.string的乘法</h6><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;🎄&#x27;</span> * i);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Output:</span></span><br><span class="line"><span class="comment">// 🎄</span></span><br><span class="line"><span class="comment">// 🎄🎄</span></span><br><span class="line"><span class="comment">// 🎄🎄🎄</span></span><br><span class="line"><span class="comment">// 🎄🎄🎄🎄</span></span><br><span class="line"><span class="comment">// 🎄🎄🎄🎄🎄</span></span><br></pre></td></tr></table></figure>

<h6 id="2-同步调用Future函数"><a href="#2-同步调用Future函数" class="headerlink" title="2.同步调用Future函数"></a>2.同步调用Future函数</h6><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//演示数据</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CovidAPI</span> </span>&#123;</span><br><span class="line">  Future&lt;<span class="built_in">int</span>&gt; getCases() =&gt; Future.value(<span class="number">1000</span>);</span><br><span class="line">  Future&lt;<span class="built_in">int</span>&gt; getRecovered() =&gt; Future.value(<span class="number">100</span>);</span><br><span class="line">  Future&lt;<span class="built_in">int</span>&gt; getDeaths() =&gt; Future.value(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用Future.wait</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> api = CovidAPI();</span><br><span class="line"><span class="keyword">final</span> values = <span class="keyword">await</span> Future.wait([</span><br><span class="line">    api.getCases(),</span><br><span class="line">    api.getRecovered(),</span><br><span class="line">    api.getDeaths(),</span><br><span class="line">]);</span><br><span class="line"><span class="built_in">print</span>(values); <span class="comment">// [1000, 100, 10]</span></span><br></pre></td></tr></table></figure>

<h6 id="3-类里的call方法"><a href="#3-类里的call方法" class="headerlink" title="3.类里的call方法"></a>3.类里的call方法</h6><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PasswordValidator</span> </span>&#123;</span><br><span class="line">  <span class="built_in">bool</span> call(<span class="built_in">String</span> password) &#123;</span><br><span class="line">    <span class="keyword">return</span> password.length &gt; <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以像方法一样直接通过实例对象调用,</p>
<p>两种调用方式</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> validator = PasswordValidator();</span><br><span class="line"><span class="comment">// can use it like this:</span></span><br><span class="line">validator(<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line">validator(<span class="string">&#x27;test1234&#x27;</span>);</span><br><span class="line"><span class="comment">// no need to use it like this:</span></span><br><span class="line">validator.call(<span class="string">&#x27;not-so-frozen-arctic&#x27;</span>);</span><br></pre></td></tr></table></figure>



<h6 id="4用”-call-”调用回调函数避免为空"><a href="#4用”-call-”调用回调函数避免为空" class="headerlink" title="4用”?.call()”调用回调函数避免为空"></a>4用”?.call()”调用回调函数避免为空</h6><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//demo类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomDraggable</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> CustomDraggable(&#123;Key key, <span class="keyword">this</span>.onDragCompleted&#125;) : <span class="keyword">super</span>(key: key);</span><br><span class="line">  <span class="keyword">final</span> VoidCallback? onDragCompleted;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">void</span> _dragComplete() &#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> Implement me</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;<span class="comment">/*...*/</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这是传统写法</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> _dragComplete() &#123;</span><br><span class="line">    <span class="keyword">if</span> (onDragCompleted != <span class="keyword">null</span>) &#123;</span><br><span class="line">      onDragCompleted();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p>另一种简便写法,为null就不会调用了,和上面等效</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Future&lt;<span class="keyword">void</span>&gt; _dragComplete() <span class="keyword">async</span> &#123;</span><br><span class="line">   onDragCompleted?.call();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>



<h6 id="5-函数作为参数传递"><a href="#5-函数作为参数传递" class="headerlink" title="5.函数作为参数传递"></a>5.函数作为参数传递</h6><p>dart里函数也是一等公民,具有和其他变量同等待遇</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> main() &#123;</span><br><span class="line">  <span class="keyword">final</span> sayHi = (name) =&gt; <span class="string">&#x27;Hi, <span class="subst">$name</span>&#x27;</span>;</span><br><span class="line">  welcome(sayHi, <span class="string">&#x27;Andrea&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> welcome(<span class="built_in">String</span> <span class="built_in">Function</span>(<span class="built_in">String</span>) greet,</span><br><span class="line">             <span class="built_in">String</span> name) &#123;</span><br><span class="line">  <span class="built_in">print</span>(greet(name));</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;Welcome to this course&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="6-容器判断和容器展开"><a href="#6-容器判断和容器展开" class="headerlink" title="6.容器判断和容器展开"></a>6.容器判断和容器展开</h6><p>…可以把容器的元素展开,也可以在容器里添加if判断语法</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> addRatings = <span class="keyword">true</span>;</span><br><span class="line"><span class="keyword">const</span> restaurant = &#123;</span><br><span class="line">  <span class="string">&#x27;name&#x27;</span> : <span class="string">&#x27;Pizza Mario&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;cuisine&#x27;</span>: <span class="string">&#x27;Italian&#x27;</span>,</span><br><span class="line">  <span class="keyword">if</span> (addRatings) ...&#123;</span><br><span class="line">    <span class="string">&#x27;avgRating&#x27;</span>: <span class="number">4.3</span>,</span><br><span class="line">    <span class="string">&#x27;numRatings&#x27;</span>: <span class="number">5</span>,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>



<h6 id="7-安全遍历map”-entries”"><a href="#7-安全遍历map”-entries”" class="headerlink" title="7.安全遍历map”.entries”"></a>7.安全遍历map”.entries”</h6><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> entry <span class="keyword">in</span> timeSpent.entries) &#123;</span><br><span class="line">  <span class="comment">// do something with keys and values</span></span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;<span class="subst">$&#123;entry.key&#125;</span>: <span class="subst">$&#123;entry.value&#125;</span>&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>比遍历key安全</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> timeSpent.keys) &#123;</span><br><span class="line">  <span class="keyword">final</span> value = timeSpent[key];</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&#x27;<span class="subst">$key</span>: <span class="subst">$value</span>&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个实现如果key对应的value是null,就会报错</p>
<h6 id="8-使用命名构造函数-更具有维护性-可读性"><a href="#8-使用命名构造函数-更具有维护性-可读性" class="headerlink" title="8.使用命名构造函数,更具有维护性,可读性"></a>8.使用命名构造函数,更具有维护性,可读性</h6><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Temperature</span> </span>&#123;</span><br><span class="line">  Temperature.celsius(<span class="keyword">this</span>.celsius);</span><br><span class="line">  Temperature.fahrenheit(<span class="built_in">double</span> fahrenheit)</span><br><span class="line">    : celsius = (fahrenheit - <span class="number">32</span>) / <span class="number">1.8</span>;</span><br><span class="line">  <span class="built_in">double</span> celsius;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h6 id="9-Getter和Setter"><a href="#9-Getter和Setter" class="headerlink" title="9.Getter和Setter"></a>9.Getter和Setter</h6><p>dart里的getter和setter的语法</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Temperature</span> </span>&#123;</span><br><span class="line">  Temperature.celsius(<span class="keyword">this</span>.celsius);</span><br><span class="line">  Temperature.fahrenheit(<span class="built_in">double</span> fahrenheit)</span><br><span class="line">    : celsius = (fahrenheit - <span class="number">32</span>) / <span class="number">1.8</span>;</span><br><span class="line">  <span class="built_in">double</span> celsius;</span><br><span class="line">  <span class="built_in">double</span> <span class="keyword">get</span> fahrenheit</span><br><span class="line">    =&gt; celsius * <span class="number">1.8</span> + <span class="number">32</span>;</span><br><span class="line">  <span class="keyword">set</span> fahrenheit(<span class="built_in">double</span> fahrenheit)</span><br><span class="line">    =&gt; celsius = (fahrenheit - <span class="number">32</span>) / <span class="number">1.8</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> temp1 = Temperature.celsius(<span class="number">30</span>);</span><br><span class="line"><span class="built_in">print</span>(temp1.fahrenheit);</span><br><span class="line"><span class="keyword">final</span> temp2 = Temperature.fahrenheit(<span class="number">90</span>);</span><br><span class="line">temp2.celsius = <span class="number">28</span>;</span><br></pre></td></tr></table></figure>



<p>10.用<code>_</code>下划线代替未使用的参数</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyListView</span> <span class="keyword">extends</span> <span class="title">StatelessWidget</span> </span>&#123;</span><br><span class="line">  <span class="meta">@override</span></span><br><span class="line">  Widget build(BuildContext context) &#123;</span><br><span class="line">    <span class="keyword">return</span> ListView.builder(</span><br><span class="line">      itemBuilder: (context, index) =&gt; ListTile(</span><br><span class="line">        title: Text(<span class="string">&#x27;all the same&#x27;</span>),</span><br><span class="line">      ),</span><br><span class="line">      itemCount: <span class="number">10</span>,</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果不使用context,index,可以写成如下</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">istView.builder(</span><br><span class="line">  itemBuilder: (_, __) =&gt; ListTile(</span><br><span class="line">    title: Text(<span class="string">&#x27;all the same&#x27;</span>),</span><br><span class="line">  ),</span><br><span class="line">  itemCount: <span class="number">10</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>_和__代表不同的参数</p>
<h6 id="11-单例实现"><a href="#11-单例实现" class="headerlink" title="11.单例实现"></a>11.单例实现</h6><p>dart的单例实现方式</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// file_system.dart</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileSystem</span> </span>&#123;</span><br><span class="line">  FileSystem._();</span><br><span class="line">  <span class="keyword">static</span> <span class="keyword">final</span> instance = FileSystem._();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>无法实例化,仅能通过以下方式访问</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// some_other_file.dart</span></span><br><span class="line"><span class="keyword">final</span> fs = FileSystem.instance;</span><br><span class="line"><span class="comment">// do something with fs</span></span><br></pre></td></tr></table></figure>



<p>12.Set</p>
<p>如果需要一个不包含重复元素的集合,那么使用Set</p>
<p>一个细节,如果使用final 修饰set,有重复元素只会提示warning</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// set is final, compiles</span></span><br><span class="line"><span class="keyword">final</span> citiesSet = &#123;</span><br><span class="line">  <span class="string">&#x27;London&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Paris&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Rome&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;London&#x27;</span>, <span class="comment">// Two elements in a set literal shouldn&#x27;t be equal</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>如果用const修复,会提示无法编译</p>
<figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// set is const, doesn&#x27;t compile</span></span><br><span class="line"><span class="keyword">const</span> citiesSet = &#123;</span><br><span class="line">  <span class="string">&#x27;London&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Paris&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;Rome&#x27;</span>,</span><br><span class="line">  <span class="string">&#x27;London&#x27;</span>, <span class="comment">// Two elements in a constant set literal can&#x27;t be equal</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>







<p><code>TODO</code></p>
<h2 id="15-Common-Stream-constructors"><a href="#15-Common-Stream-constructors" class="headerlink" title="15. Common Stream constructors"></a><a target="_blank" rel="noopener" href="https://codewithandrea.com/videos/2020-11-16-top-dart-tips-and-tricks-for-flutter-devs/#15-common-stream-constructors">15. Common Stream constructors</a></h2><p>The Stream class also comes with some handy constructors. Here are the most common ones:</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="module-access"><span class="module"><span class="identifier">Stream</span>.</span></span>from<span class="constructor">Iterable([1, 2, 3])</span>;</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Stream</span>.</span></span>value(<span class="number">10</span>);</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Stream</span>.</span></span>empty<span class="literal">()</span>;</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Stream</span>.</span></span>error(<span class="constructor">Exception(&#x27;<span class="params">something</span> <span class="params">went</span> <span class="params">wrong</span>&#x27;)</span>);</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Stream</span>.</span></span>from<span class="constructor">Future(Future.<span class="params">delayed</span>(Duration(<span class="params">seconds</span>: 1)</span>,<span class="function"> <span class="params">()</span> =&gt;</span> <span class="number">42</span>));</span><br><span class="line"><span class="module-access"><span class="module"><span class="identifier">Stream</span>.</span></span>periodic(<span class="constructor">Duration(<span class="params">seconds</span>: 1)</span>,<span class="function"> (<span class="params">index</span>) =&gt;</span> index);</span><br></pre></td></tr></table></figure>

<ul>
<li>use <code>Stream.fromIterable</code> to create a <code>Stream</code> from a list of values.</li>
<li>use <code>Stream.value</code> if you have just one value.</li>
<li>use <code>Stream.empty</code> to create an empty stream.</li>
<li>use <code>Stream.error</code> to create a stream that contains an error value.</li>
<li>use <code>Stream.fromFuture</code> to create a stream that will contain only one value, and that value will be available when the future completes.</li>
<li>use <code>Stream.periodic</code> to create a periodic stream of events. You can specify a <code>Duration</code> as the time interval between events, and an anonymous function to generate each value given its index in the stream.</li>
</ul>
<h2 id="16-Sync-and-Async-Generators"><a href="#16-Sync-and-Async-Generators" class="headerlink" title="16. Sync and Async Generators"></a><a target="_blank" rel="noopener" href="https://codewithandrea.com/videos/2020-11-16-top-dart-tips-and-tricks-for-flutter-devs/#16-sync-and-async-generators">16. Sync and Async Generators</a></h2><p>In Dart we can define a <strong>synchronous</strong> generator as a function that returns an <code>Iterable</code>:</p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Iterable&lt;<span class="built_in">int</span>&gt; <span class="built_in">count</span>(<span class="built_in">int</span> <span class="built_in">n</span>) sync* &#123;</span><br><span class="line">  for (<span class="built_in">var</span> i = <span class="number">1</span>; i &lt;= <span class="built_in">n</span>; i++) &#123;</span><br><span class="line">    <span class="built_in">yield</span> i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This uses the <code>sync*</code> syntax. Inside the function we can “generate” or <code>yield</code> multiple values. These will be returned as an <code>Iterable</code> when the function completes.</p>
<hr>
<p>On the other hand, an <strong>asynchronous</strong> generator is a function that returns a <code>Stream</code>:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Stream&lt;<span class="keyword">int</span>&gt; <span class="title">countStream</span>(<span class="params"><span class="keyword">int</span> n</span>) <span class="keyword">async</span>*</span> &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="keyword">yield</span> i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This uses this <code>async*</code> syntax. Inside the function we can <code>yield</code> values just like in the synchronous case.</p>
<p>But if we want we can <code>await</code> on Future-based APIs, because this is an <strong>asynchronous</strong> generator:</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Stream&lt;<span class="built_in">int</span>&gt; count<span class="constructor">Stream(<span class="params">int</span> <span class="params">n</span>)</span> async* &#123;</span><br><span class="line">  <span class="keyword">for</span> (var i = <span class="number">1</span>; i &lt;= n; i++) &#123;</span><br><span class="line">    <span class="comment">// dummy delay - this could be a network request</span></span><br><span class="line">    await <span class="module-access"><span class="module"><span class="identifier">Future</span>.</span></span>delayed(<span class="constructor">Duration(<span class="params">seconds</span>: 1)</span>);</span><br><span class="line">    yield i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>转自</p>
<p><a target="_blank" rel="noopener" href="https://codewithandrea.com/videos/2020-11-16-top-dart-tips-and-tricks-for-flutter-devs/#8-use-named-constructors-and-initializer-lists-for-more-ergonomic-apis">https://codewithandrea.com/videos/2020-11-16-top-dart-tips-and-tricks-for-flutter-devs/#8-use-named-constructors-and-initializer-lists-for-more-ergonomic-apis</a></p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">标签</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/flutter/" rel="tag">flutter</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a
                        class="post-action-btn btn btn--disabled"
                        aria-hidden="true"
                    >
                        
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/11/08/2020-11-08-Stateful-Widget-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"
                    data-tooltip="Stateful Widget 生命周期"
                    aria-label="下一篇: Stateful Widget 生命周期"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2020 krela. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a
                        class="post-action-btn btn btn--disabled"
                        aria-hidden="true"
                    >
                        
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">上一篇</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2020/11/08/2020-11-08-Stateful-Widget-%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/"
                    data-tooltip="Stateful Widget 生命周期"
                    aria-label="下一篇: Stateful Widget 生命周期"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">下一篇</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                

            
        </div>
        


<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <h4 id="about-card-name">krela</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('https://cdn.jsdelivr.net/gh/krela2010/picstore/img/0_HQm1yU37T9Kn0Sqk.jpg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/script-efzwyj1ubluyv8iapkoolcjuvxznfol9f88lx15p6wxkixuzt5pme1zhhnhc.min.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
